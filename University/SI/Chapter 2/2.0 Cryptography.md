
# Cryptography Principles and Practices

## 1. Introduction to Cryptography, Cryptanalysis, and Cryptology

Cryptography is the science of using mathematical techniques to encrypt (encode) and decrypt (decode) data, ensuring secure communication. Cryptanalysis is the study of encrypted information to discover its hidden content without access to the key. Cryptology is the broader field encompassing both cryptography and cryptanalysis.

**Clarification & Context (from Dr. RIAHLA, `FILE 1.1`)**
This note defines the core concepts of modern cryptographic science, focusing on the distinctions between **cryptography**, **cryptanalysis**, and **cryptology**.

---

### üîê Cryptography

**Definition:**
Cryptography is the scientific discipline that uses **mathematical techniques** to **encrypt (encode)** and **decrypt (decode)** data. It is the foundation for securing digital communication and protecting sensitive information from unauthorized access.

-   **Goal:** Ensure **confidentiality**, **integrity**, **authentication**, and **non-repudiation**.
-   **Applications:** Secure communications, digital signatures, secure storage, authentication protocols.

(Source: `FILE 1.1`, `FILE 3 - Definitions (Cryptography and Cryptanalysis)`, Slides: `Introduction √† la cryptographie` p5)

### üïµÔ∏è Cryptanalysis

**Definition:**
Cryptanalysis is the study of encrypted information with the objective of **discovering the hidden content** without access to the encryption key.

-   **Focus:** Breaking or bypassing cryptographic security.
-   **Methods:** Brute-force attacks, frequency analysis, mathematical analysis, side-channel attacks.

(Source: `FILE 1.1`, `FILE 3 - Definitions (Cryptography and Cryptanalysis)`)

### üìö Cryptology

**Definition:**
Cryptology is the broader field that encompasses both **cryptography** and **cryptanalysis**.

-   In other words:
    **`Cryptology = Cryptography + Cryptanalysis`**

(Source: `FILE 1.1`, `FILE 3 - Definitions (Cryptography and Cryptanalysis)`)

### Summary Table: Core Definitions

| Term          | Definition                                                                 |
|---------------|-----------------------------------------------------------------------------|
| Cryptography  | The science of encoding and decoding information using mathematical tools. |
| Cryptanalysis | The science of analyzing encrypted data to uncover the original message.   |
| Cryptology    | The combined study of cryptography and cryptanalysis.                      |

(Source: `FILE 1.1`)

### Basic Terminology

-   **Plaintext ('M'):** The original, unmodified message.
-   **Ciphertext ('C'):** The encrypted, incomprehensible message. `C = E(M)`.
-   **Key (K, Ke, Kd):** Information allowing encryption and decryption.
-   **Encryption (E):** Function transforming plaintext to ciphertext. `C = E_ke(M)`.
-   **Decryption (D):** Function reconstructing plaintext from ciphertext. `M = D_kd(C)`.
    -   Thus: `D_kd(E_ke(M)) = M`.

(Source: `FILE 3 - Definitions (Terminology)`, Slides: `Introduction √† la cryptographie` p11-12)

### Traditional Protagonists

-   **Alice and Bob:** Wish to communicate securely.
-   **Oscar or Mallory:** An opponent wishing to spy on or interfere with Alice and Bob's communication.

(Source: `FILE 3 - Definitions`)

### Protecting Information: Cryptography vs. Steganography

-   **Steganography:** Hides the *existence* of information (e.g., tattooing a message on a shaved head and waiting for hair to regrow; modernly, hiding data within other files).
-   **Cryptography:** Modifies information to make it incomprehensible without the key. Involves two main categories:
    -   **Transposition:** The order of elements is modified (e.g., shuffling characters).
    -   **Substitution:** Elements are replaced by others (e.g., 'A' becomes 'D').

(Source: `FILE 3 - History and Introduction (Protecting Information, Steganography, Cryptography, Cryptography Categories)`, Slides: `Introduction √† la cryptographie` p8, p13-14)

### Historical Overview

-   **IV Century BC (Scytale):** A transposition cipher using a rod of a specific diameter to encrypt/decrypt messages written on a strip of parchment.
-   **58 BC (Caesar Cipher):** Julius Caesar used a simple substitution cipher with a shift of 3.
-   **9th Century (Al-Kindi):** Arab mathematician Abu Yusuf Ya'qub ibn Ishaq al-Sabbah Al-Kindi introduced cryptanalysis techniques, notably frequency analysis.
-   **1586 (Vigen√®re Cipher):** A polyalphabetic substitution cipher, considered a significant improvement over simpler substitution ciphers.
-   **World War I & II (Enigma Machine):** Mechanical rotor cipher machine used by Germany, famously broken by Allied cryptanalysts.
-   **Modern Era (DES, AES, etc.):** Development of standardized, strong cryptographic algorithms.

(Source: `FILE 3 - History and Introduction (Caesar Cipher)`, Slides: `Introduction √† la cryptographie` p6-7)

### Objectives of Cryptography

| Objective         | Description                                                                | Method/Tool Example        |
|-------------------|----------------------------------------------------------------------------|---------------------------|
| Confidentiality   | Prevents unauthorized access to information.                               | Encryption algorithms     |
| Integrity         | Ensures information has not been altered during transmission or storage.     | Hash functions, MACs      |
| Authentification  | Verifies the identity of users or systems.                                 | Digital signatures, MACs  |
| Non-repudiation   | Prevents a sender from denying they sent a message.                        | Digital signatures        |

(Source: `FILE 3 - How to Ensure Other Security Objectives???`, Slides: `Introduction √† la cryptographie` p5)

## 2. Classical Ciphers and Cryptanalysis

This section explores classical encryption techniques, their weaknesses, and methods of cryptanalysis.

### Caesar Cipher

The Caesar cipher is one of the simplest and most well-known classical encryption techniques. It's a substitution cipher where each letter in the plaintext is shifted a certain number of places down or up the alphabet.

**Example: Caesar Cipher with a Shift of 3**
To encrypt the word `CRYPTOGRAPHY` with a shift of **3**:
Plain Alphabet:  `ABCDEFGHIJKLMNOPQRSTUVWXYZ`
Cipher Alphabet: `DEFGHIJKLMNOPQRSTUVWXYZABC`
Plaintext: `CRYPTOGRAPHY`
Ciphertext: `FUBSWRJUDSKLH`

(Source: `FILE 1 - Chiffrement de C√©sar.md`, `FILE 3 - Caesar Cipher`, `Solution TD2 - Exercice 1 Q1`)

**Formalization:**
Let letters A-Z be represented by numbers 0-25.
-   Key `K`: The shift amount (0 < K < 26).
-   Encryption: `C = E(M) = (M + K) mod 26`
-   Decryption: `M = D(C) = (C - K) mod 26`

(Source: `FILE 3 - Caesar Cipher (Formula)`, Slides: `Introduction √† la cryptographie` p16)

**Weaknesses:**
-   **Limited Keyspace:** Only 26 possible keys. Brute-force attack is trivial (trying all 26 shifts).
    -   Example from `Solution TD2 - Exercice 1 Q2`: Decrypting `HJHTIJUJZYJYWJHFXXJ KFHNQJRJSY` with key=5 yields `CE CODE PEUT ETRE CASSER FACILEMENT`.
-   A human attacker can decrypt it in minutes.

(Source: `FILE 1 - Chiffrement de C√©sar.md`, `FILE 3 - Caesar Cipher (Cryptanalysis)`)

**Cryptanalysis: Brute-Force**
Given a ciphertext, one can try all 25 possible (non-zero) shifts. The shift that results in a meaningful plaintext is the correct key.

**Cryptanalysis: Frequency Analysis (for longer texts)**
While brute force is easy, frequency analysis can also be applied.
-   If a message is long enough, the frequency of letters in the ciphertext will reflect the shifted frequencies of the plaintext language.
-   Example from `Solution TD2 - Exercice 1 Q3`: Decrypting `ZSGAS HWSFG RWBHS FBSH`.
    -   The letter 'S' appears most frequently (5 times). Assuming 'S' corresponds to 'E' (the most common letter in English/French), the shift K would be:
        `Index(S) - Index(E) = 18 - 4 = 14`.
    -   Decrypting with K=14 yields `LES METIERS D INTERNET`.

(Source: `Solution TD2 - Exercice 1 Q3, Q4`)

**Special Case: ROT13 (Shift of 13)**
If K=13, applying the Caesar cipher twice returns the original message. `E(E(M)) = M`. This is because `(M + 13 + 13) mod 26 = (M + 26) mod 26 = M mod 26`.
(Source: `Solution TD2 - Exercice 1 Q5`)

### Improved Version: Randomized Substitution Cipher (Monoalphabetic Substitution)

To overcome the limited keyspace of the Caesar cipher, a randomized substitution cipher uses a shuffled alphabet as the key. Each letter of the plaintext alphabet is mapped to a unique, randomly selected letter.

**Example:**
Plain:  `ABCDEFGHIJKLMNOPQRSTUVWXYZ`
Cipher: `OHGFEDCBUKJPNMIQRXSTLZXYWV` (A random permutation)

**Keyspace Size:**
-   The number of possible keys is **26! (factorial of 26)**.
-   `26! ‚âà 4 √ó 10¬≤‚Å∂` possible keys.
-   Brute-force attacks are virtually impossible.

(Source: `FILE 1 - Chiffrement de C√©sar.md`, `FILE 3 - Caesar Cipher (Random Substitution)`)

**Cryptanalysis: Frequency Analysis Attack**
Despite the large keyspace, these ciphers are vulnerable to statistical attacks, specifically frequency analysis.
1.  **Analyze** the frequency of each letter in the ciphertext.
2.  **Compare** with known frequencies of letters in the plaintext language (e.g., English: E, T, A, O, I, N, S, H, R...).
3.  **Match** the most frequent ciphertext letters with the expected plaintext letters.
4.  **Deduce** parts of the substitution key.
5.  **Refine** through iteration, pattern recognition (digrams, trigrams, common words).
[[Q8]]
(Source: `FILE 1 - Chiffrement de C√©sar.md`, `FILE 3 - Caesar Cipher (Random Substitution: Cryptanalysis)`)

### Vigen√®re Cipher

The Vigen√®re cipher is a polyalphabetic substitution cipher that uses a series of Caesar ciphers based on the letters of a keyword.

**Overview:**
-   Each letter in the plaintext is shifted differently based on the corresponding letter in the keyword. If the keyword is shorter than the plaintext, it is repeated.
-   Example: Plaintext `P`, Keyword `K`. `C_i = (P_i + K_i) mod 26`.

(Source: `FILE 2 - Chiffrment Vigen√®re.md`)

**Example (from `Solution TD2 - Exercice 2 Q1`):**
Encrypt `CHIFFREMENT DE VIGENERE` with key `SECU`.
(S=18, E=4, C=2, U=20)
Plaintext:   `C H I F F R E M E N T  D E V I G E N E R E`
Codes:       `2 7 8 5 517 412 41319  3 421 8 6 413 417 4`
Key Stream:  `S E C U S E C U S E C  U S E C U S E C U S`
Key Codes:   `184 22018 4 22018 4 2 2018 4 22018 4 22018`
Cipher Codes: (`P_i + K_i`) mod 26
             `20 11 10 25 23 21 6 32_(_‚â°6_)_ 22 17 21 23 22 25 10 26_(_‚â°0_)_ 22 17 6 37_(_‚â°11_)_ 22`
Ciphertext:  `U  L  K  Z  X  V G  G        W  R  V  X  W  Z  K  A        W  R G  L        W`

(Resulting ciphertext: `ULKZXVGGWRVXWZKAWRGLW`)

**Decryption Example (from `Solution TD2 - Exercice 2 Q2`):**
Decrypt `OFBJESUVAJKWVVGCYCTDYIBEWV` with key `CRYPTO`.
Yields: `MODULE SECURITE INFORMATIQUE`

**Cryptanalysis of Vigen√®re Cipher:**
-   **Key Length Determination:**
    -   **Kasiski Examination:** Look for repeated sequences of 3 or more characters in the ciphertext. The distances between these repetitions are often multiples of the key length. Find the Greatest Common Divisor (GCD) of these distances.
    -   **Index of Coincidence (IC):** Measures the probability that two randomly chosen letters from a text are identical.
        -   For a random text: IC ‚âà 1/26 ‚âà 0.038
        -   For English text: IC ‚âà 0.065 - 0.078 (depending on source and language variant)
        -   Divide the ciphertext into `m` columns (assuming key length `m`). Calculate IC for each column. If `m` is the correct key length, IC for each column should be close to that of the plaintext language.
-   **Key Determination:** Once key length `m` is found, the ciphertext can be treated as `m` separate monoalphabetic ciphers (Caesar ciphers), each of which can be attacked using frequency analysis.

(Source: `Solution TD2 - Exercice 2 Q3` details an attack, slides `Introduction √† la cryptographie` p30-34)
In `Solution TD2 - Exercice 2 Q3`, for a key length of 2, the ciphertext is split. Frequencies for c1 and c2 are analyzed.
-   c1: `OFBWJDPGYJQUQVSXFQLHHHRMXVRPXSRRRHX` (R is most frequent)
-   c2: `SFDCFASSWSSSSHZGCGRFRBGCFQASBFHQZGF` (S is most frequent)
Assuming R -> E gives k1=13 ('N'). Assuming S -> E gives k2=14 ('O'). Key "NO".
If this fails, other high-frequency mappings are tried. In the solution, H -> E (k1=3, 'D') was chosen for the first part.
Final key: "DO". Message: "LE CRYPTO GRAMME DE VIGENERE N EST PLUS CONSIDERE DE NOS JOURS COMME UN PROTOCOLE SUR".

### Other Classical Systems

-   **Scytale:** Transposition cipher using a rod. Order of letters changed.
-   **Polybius Square:** Substitution cipher using a grid to convert letters to coordinate pairs.
-   **Columnar Transposition:** Plaintext written in rows under a keyword, ciphertext read off column by column based on alphabetical order of keyword letters.
-   **Playfair Cipher:** Polygraphic substitution cipher, encrypts pairs of letters.
-   **Hill Cipher:** Polygraphic substitution using matrices.
-   **Vernam Cipher (One-Time Pad):** Theoretically unbreakable if the key is truly random, used only once, and as long as the message. `C = P XOR K`.
-   **Enigma Machine:** Electro-mechanical rotor machine used in WWII.

(Source: `FILE 3 - Other Classical Systems`, Slides: `Introduction √† la cryptographie` p8, p9, p14, p35-36)

### Summary of Classical Cipher Weaknesses

| Cipher Type                | Keyspace Size | Vulnerable To                  | Time to Break (Conceptual) |
|----------------------------|---------------|--------------------------------|----------------------------|
| Caesar Cipher              | 26            | Brute-force, Frequency analysis | Minutes                    |
| Randomized Substitution    | 26! ‚âà 4√ó10¬≤‚Å∂   | Frequency analysis             | Minutes to hours (manual)  |
| Vigen√®re Cipher            | 26<sup>L</sup> (L=key length) | Kasiski, IC, Frequency analysis | Depends on key length      |

(Source: `FILE 1 - Chiffrement de C√©sar.md` Summary)

[[Q9]]
## 3. Symmetric Cryptography (Private-Key Cryptography)

Symmetric cryptography uses the **same key** for both encryption and decryption.

-   If `ke` is the encryption key and `kd` is the decryption key, then in symmetric cryptography: **`ke = kd = k`**.
-   Both sender and receiver must possess the same secret key before communication.

(Source: `FILE 2 - Chiffrment Vigen√®re.md`, `FILE 3 - Symmetric Cryptography`, Slides: `Introduction √† la cryptographie` p42, p47)

### Real-World Examples (Algorithms)

-   **DES** (Data Encryption Standard)
-   **3DES** (Triple DES)
-   **AES** (Advanced Encryption Standard) - Widely used by governments, including the U.S. federal government.

(Source: `FILE 2 - Chiffrment Vigen√®re.md`, `FILE 3 - Symmetric Cryptography`, Slides: `Introduction √† la cryptographie` p47, p52)

### Advantages

-   **High speed:** Generally much faster than asymmetric methods.
-   **Efficiency:** Suitable for encrypting large amounts of data.

(Source: `FILE 2 - Chiffrment Vigen√®re.md`, `FILE 3 - Symmetric Cryptography (Advantages and Disadvantages)`, Slides: `Introduction √† la cryptographie` p67)

### Main Disadvantage: Key Distribution Problem

How can the key be shared securely between parties without being intercepted?
-   This becomes complex as the number of users increases.
    -   For `N` users to communicate pairwise, `N * (N-1) / 2` keys are needed.
    (Source: `Solution TD2 - Exercice 3 Q1`, Slides: `Introduction √† la cryptographie` p68)
-   The "Padlock Protocol" (Alice sends box with her lock, Bob adds his, Alice removes hers, Bob removes his) is an analogy for secure exchange but illustrates an interactive multi-step process, not directly how symmetric keys are distributed typically. It leads to the idea of asymmetric crypto.
(Source: `FILE 3 - Symmetric Cryptography (How to Share a Secret? - Padlock Protocol)`, Slides: `Introduction √† la cryptographie` p70)

### Modern Symmetric Ciphers: Concepts

-   **Block Ciphers vs. Stream Ciphers:**
    -   **Block Ciphers:** Encrypt fixed-size blocks of plaintext (e.g., AES, DES).
    -   **Stream Ciphers:** Encrypt data bit by bit or byte by byte (e.g., RC4 - though now deprecated).
    (Slides: `Introduction √† la cryptographie` p43)
-   **Confusion and Diffusion (Shannon's Properties):**
    -   **Confusion:** Obscures the relationship between the ciphertext and the key. Achieved through substitution (e.g., S-boxes).
    -   **Diffusion:** Spreads the influence of a single plaintext bit over many ciphertext bits (and vice-versa). Achieved through transposition/permutation.
    -   Modern ciphers use multiple rounds of substitution and permutation (product ciphers).
    (Slides: `Introduction √† la cryptographie` p45)
-   **Avalanche Effect:** A small change in plaintext or key should produce a significant change in ciphertext.
    (Slides: `Introduction √† la cryptographie` p46)

### Simplified DES (S-DES) - Pedagogical Example

S-DES is a simplified version of DES used for educational purposes.
-   **Input/Output:** 8-bit blocks
-   **Key:** 10-bits, from which two 8-bit subkeys (K1, K2) are generated.
-   **Rounds:** 2
-   **Structure:**
    1.  Initial Permutation (IP)
    2.  Round 1: Complex function `f_K1` (involves expansion, XOR with subkey, S-Boxes, permutation P4), followed by XOR with left half, then Swap halves.
    3.  Round 2: Complex function `f_K2`, XOR with left half. (No swap after last round).
    4.  Final Permutation (IP<sup>-1</sup>)
-   **S-Boxes:** Substitution tables that provide non-linearity. S-DES uses two S-Boxes (S0, S1). A 4-bit input to an S-Box produces a 2-bit output. The outer two bits of the input select the row, and the inner two bits select the column.
-   **Key Generation:** From a 10-bit key, P10 permutation, split into two 5-bit halves, left shifts (LS-1 for K1, LS-2 for K2 on shifted K1 halves), P8 permutation to get 8-bit subkeys.

(Detailed steps and example in Slides: `Introduction √† la cryptographie` p48-59)

### Modes of Operation for Block Ciphers

When encrypting messages larger than a single block, a mode of operation is needed.
-   **Electronic Codebook (ECB):**
    -   Each block encrypted independently with the same key.
    -   **Weakness:** Identical plaintext blocks result in identical ciphertext blocks, revealing patterns. Not recommended for general use.
    (Slides: `Introduction √† la cryptographie` p58-59)
-   **Cipher Block Chaining (CBC):**
    -   Each plaintext block is XORed with the *previous* ciphertext block before encryption.
    -   Requires an **Initialization Vector (IV)** for the first block, which must be unique but not necessarily secret.
    -   Hides patterns; identical plaintext blocks encrypt to different ciphertext blocks.
    (Slides: `Introduction √† la cryptographie` p60)
-   **Cipher Feedback (CFB):**
    -   Turns a block cipher into a stream cipher.
    -   Previous ciphertext block is encrypted, and the output is XORed with current plaintext block to get current ciphertext.
    -   Uses an IV.
    (Slides: `Introduction √† la cryptographie` p62)
-   **Output Feedback (OFB):**
    -   Turns a block cipher into a stream cipher.
    -   A keystream is generated independently of plaintext/ciphertext by repeatedly encrypting an IV. Plaintext is XORed with keystream.
    -   **Error Propagation:** Bit errors in ciphertext only affect corresponding plaintext bit.
    -   **IV Reuse Critical:** Reusing an IV with the same key for different messages is catastrophic (allows recovery of `P1 XOR P2`).
    (Slides: `Introduction √† la cryptographie` p63, p66 - IV reuse attack example)
-   **Counter (CTR):**
    -   Turns a block cipher into a stream cipher.
    -   Encrypts successive values of a "counter" (nonce + counter value) to produce a keystream. Plaintext XORed with keystream.
    -   Allows parallel encryption/decryption.
    (Slides: `Introduction √† la cryptographie` p64)

[[Q10]]
## 4. Asymmetric Cryptography (Public-Key Cryptography)

Asymmetric cryptography uses a **pair of keys**:
-   A **public key**, known by all, used for encryption or signature verification.
-   A **private key**, kept secret by the owner, used for decryption or signing.
-   A message encrypted with a public key can **only be decrypted with the corresponding private key**.

(Source: `FILE 3 - Asymmetric Cryptography`, Slides: `Introduction √† la cryptographie` p72-73)

**Analogy (Padlocks at Post Office):**
Bob leaves open padlocks (public keys) at the post office. Alice can take one, secure her package, and send it to Bob. Only Bob, with his unique key (private key), can open his padlock.
(Source: `FILE 3 - Asymmetric Cryptography (Padlock Analogy)`)

### Advantages

-   **Solves Key Distribution:** No need to share a secret key beforehand for confidentiality. Alice uses Bob's public key to encrypt a message for Bob.
-   **Enables Digital Signatures:** Provides authentication, integrity, and non-repudiation.

### Disadvantages

-   **Slow Speed:** Computationally intensive, much slower (e.g., 100-1000 times) than symmetric algorithms like AES.
(Source: `FILE 3 - Asymmetric Cryptography (Details)`, Slides: `Introduction √† la cryptographie` p95)

### Hybrid Approach

Due to speed limitations, asymmetric cryptography is often used in a hybrid manner:
1.  A fast symmetric **session key** is generated.
2.  The actual message is encrypted using this symmetric session key (e.g., with AES).
3.  The symmetric session key is then encrypted using the recipient's **public key** (e.g., with RSA).
4.  Both the (symmetrically) encrypted message and the (asymmetrically) encrypted session key are sent to the recipient.
5.  The recipient uses their private key to decrypt the session key, then uses the session key to decrypt the message.
(Source: `FILE 3 - Asymmetric Cryptography (Example in PGP System)`, Slides: `Introduction √† la cryptographie` p97)

For N users, N key pairs are needed. (Source: `Solution TD2 - Exercice 3 Q3`)

### Algorithms

Based on computationally hard mathematical problems:
-   **RSA:** Factoring large prime numbers.
-   **ElGamal:** Discrete logarithm problem.
-   **Merkle-Hellman:** Knapsack problem (largely broken).
-   **Elliptic Curve Cryptography (ECC):** Discrete logarithm problem on elliptic curves; offers similar security with smaller key sizes than RSA.

(Source: `FILE 3 - Asymmetric Cryptography (Algorithms)`, Slides: `Introduction √† la cryptographie` p93)
[[Q11]]
## 5. RSA Algorithm

Developed by Rivest, Shamir, and Adleman in 1977.

**Key Generation:**
1.  Choose two large distinct prime numbers, `p` and `q`.
2.  Calculate `n = p * q`. (This is the modulus for both public and private keys).
3.  Calculate Euler's totient function: `√∏(n) = (p-1) * (q-1)`.
4.  Choose an integer `e` (public exponent) such that `1 < e < √∏(n)` and `gcd(e, √∏(n)) = 1` (i.e., `e` and `√∏(n)` are coprime).
5.  Calculate `d` (private exponent) such that `d * e ‚â° 1 (mod √∏(n))`. `d` is the modular multiplicative inverse of `e` modulo `√∏(n)`. This can be found using the Extended Euclidean Algorithm.

-   **Public Key:** `(n, e)`
-   **Private Key:** `(n, d)` (or `(p, q, d)`)

(Source: `FILE 3 - Asymmetric Cryptography (RSA: The First Public Key Protocol)`, Slides: `Introduction √† la cryptographie` p82, p84)

**Encryption (Alice sends message `M` to Bob):**
Alice obtains Bob's public key `(n_B, e_B)`.
Ciphertext `C = M^e_B mod n_B`.
(Plaintext `M` must be an integer `0 <= M < n`).

**Decryption (Bob receives `C`):**
Bob uses his private key `d_B`.
Plaintext `M = C^d_B mod n_B`.

(Source: `FILE 3 - Asymmetric Cryptography (RSA: The First Public Key Protocol)`, Slides: `Introduction √† la cryptographie` p82)

**Example (from `FILE 3` and slides `Introduction √† la cryptographie` p84, p87, p90):**
1.  `p = 17`, `q = 11`
2.  `n = 17 * 11 = 187`
3.  `√∏(n) = (17-1) * (11-1) = 16 * 10 = 160`
4.  Choose `e = 7` (since `gcd(7, 160) = 1`)
5.  Find `d` such that `7 * d ‚â° 1 (mod 160)`. Using Extended Euclidean Algorithm: `d = 23`.
    (`7 * 23 = 161 ‚â° 1 (mod 160)`)

-   Public Key: `(187, 7)`
-   Private Key: `(187, 23)`

Encrypt message `M = 30`:
`C = 30^7 mod 187 = 21870000000 mod 187 = 123`

Decrypt ciphertext `C = 123`:
`M = 123^23 mod 187 = 30`

**Security of RSA:** Relies on the difficulty of factoring the large integer `n` into its prime factors `p` and `q`. If `n` can be factored, `√∏(n)` can be found, and then `d` can be computed from `e`.
-   RSA challenges (e.g., RSA-129 factored after 17 years) demonstrate this difficulty for large `n`.
(Source: `FILE 3 - Asymmetric Cryptography (RSA Challenge)`, Slides: `Introduction √† la cryptographie` p80)
[[Q12]]
## 6. Hash Functions

A hash function takes a variable-length input (message) and produces a fixed-length output called a hash value, message digest, or fingerprint.

(Source: `FILE 3 - Digital Signature (Hash Function)`, Slides: `Introduction √† la cryptographie` p99)

**Properties:**
1.  **Pre-image Resistance (One-way):** Given a hash value `h`, it is computationally infeasible to find an input `x` such that `H(x) = h`.
2.  **Second Pre-image Resistance (Weak Collision Resistance):** Given an input `x`, it is computationally infeasible to find a *different* input `x'` such that `H(x) = H(x')`.
3.  **Collision Resistance (Strong Collision Resistance):** It is computationally infeasible to find any two distinct inputs `x` and `x'` such that `H(x) = H(x')`. (This is the hardest property to achieve).
4.  **Deterministic:** The same input message always produces the same hash value.
5.  **Efficiency:** Easy and fast to compute `H(x)` for any given `x`.
6.  **Avalanche Effect:** A small change in the input message should result in a drastically different hash value.

(Source: Slides: `Introduction √† la cryptographie` p100)

**Merkle-Damg√•rd Construction:**
A common method for constructing hash functions (like MD5, SHA-1, SHA-2). It processes the message in blocks, using a compression function iteratively.
(Source: Slides: `Introduction √† la cryptographie` p104)

**Examples:**
-   **MD5 (Message Digest 5):** Produces a 128-bit hash. Considered insecure due to collision vulnerabilities.
-   **SHA-1 (Secure Hash Algorithm 1):** Produces a 160-bit hash. Also considered insecure for collision resistance.
-   **SHA-2 Family (SHA-256, SHA-512, etc.):** Produce longer hashes (e.g., 256-bit, 512-bit). Currently considered secure.
-   **SHA-3:** A newer standard, selected through a public competition.

(Source: `FILE 3 - Digital Signature (Examples of Hash Functions)`, Slides: `Introduction √† la cryptographie` p103)

**Use in Data Integrity:** If `H(M_original) != H(M_received)`, then the message has been altered. (Vulnerable to Man-in-the-Middle if hash is not secured).
(Source: Slides: `Introduction √† la cryptographie` p105)
[[Q12]]
## 7. Digital Signatures

Digital signatures provide:
-   **Authentication:** Verifies the sender's identity.
-   **Integrity:** Ensures the message has not been altered.
-   **Non-repudiation:** Prevents the sender from denying they sent the message.

(Source: `FILE 3 - Digital Signature`, Slides: `Introduction √† la cryptographie` p73, p106-107, p112)

**Process (using Asymmetric Cryptography and Hash Functions):**
1.  **Signing (by Sender Alice):**
    a.  Create a hash `h = H(M)` of the message `M`.
    b.  Encrypt the hash `h` using Alice's **private key** `d_A`: Signature `S = E_dA(h) = h^dA mod nA`.
    c.  Send the message `M` and the signature `S` to Bob.
2.  **Verification (by Receiver Bob):**
    a.  Decrypt the signature `S` using Alice's **public key** `e_A`: `h' = D_eA(S) = S^eA mod nA`.
    b.  Create a new hash of the received message `M`: `h_M = H(M)`.
    c.  Compare `h'` and `h_M`. If they are identical, the signature is valid (message is authentic, from Alice, and has integrity).

(Source: `FILE 3 - Digital Signature (Hash Function: PGP Example)`, Slides: `Introduction √† la cryptographie` p109, p111, p118)

**Problem if Bob loses his private key (from `Solution TD2 - Exercice 4`):**
-   **Can Bob still send encrypted emails?** Yes, he encrypts *for others* using *their* public keys.
-   **Can Bob still receive encrypted emails?** No, he cannot decrypt emails encrypted with his public key if he has lost the corresponding private key.
-   **Can Bob still sign emails he sends?** No, signing requires his private key.
-   **Can Bob still verify signatures on emails he receives?** Yes, verification uses the *sender's* public key.
-   **What should Bob do?** Generate a new key pair. Revoke the old public key/certificate (if applicable) to inform others not to use it.
[[Q13]]
## 8. Digital Certificates and Public Key Infrastructure (PKI)

**Problem:** How do you trust that a public key actually belongs to the person/entity it claims to? An attacker (Mallory) could substitute their own public key, impersonating Alice to Bob (Man-in-the-Middle attack).
(Source: `FILE 3 - Another Problem with Asymmetric Cryptography`, Slides: `Introduction √† la cryptographie` p113)

**Solution: Digital Certificates**
A digital certificate is an electronic document that uses a digital signature to bind a public key with an identity (information such as the name of a person or an organization, their address, and so forth).
-   Issued by a **Certificate Authority (CA)**, a trusted third party.
-   The CA verifies the identity of the entity requesting the certificate and then digitally signs the certificate with the CA's own private key.

(Source: `FILE 3 - Digital Certificates`, Slides: `Introduction √† la cryptographie` p114, p120)

**X.509 Certificate Standard:**
A widely used standard format for public key certificates. Key fields include:
-   Version
-   Serial Number (unique per CA)
-   Signature Algorithm ID (used by CA to sign this cert)
-   Issuer Name (CA's Distinguished Name - DN)
-   Validity Period (Not Before, Not After dates)
-   Subject Name (Certificate owner's DN)
-   Subject's Public Key Information (algorithm, public key itself)
-   Extensions (optional additional information)
-   CA's Digital Signature

(Source: `FILE 3 - Digital Certificates (Examples - X.509 Certificate)`, Slides: `Introduction √† la cryptographie` p115-116)

**Chain of Trust (Certificate Hierarchy):**
Users typically trust a set of Root CAs. Root CA certificates are self-signed or signed by a higher-level Root CA. Root CAs can issue certificates to Intermediate CAs, which can then issue certificates to end-entities (e.g., web servers, users). A certificate is validated by checking the signature of its issuer, then the issuer's certificate's signature, and so on, up to a trusted Root CA.
(Source: Slides: `Introduction √† la cryptographie` p123, p125, p129)

**Public Key Infrastructure (PKI):**
The entire system of hardware, software, policies, standards, CAs, Registration Authorities (RAs), directories, and procedures used to create, manage, distribute, use, store, and revoke digital certificates.
-   **Registration Authority (RA):** Verifies identity of entities requesting certificates, but doesn't sign them.
-   **Certificate Revocation List (CRL):** A list of certificates that have been revoked by the CA before their scheduled expiration date.

(Source: `FILE 3 - PKI (Public Key Infrastructure)`, Slides: `Introduction √† la cryptographie` p117, p118, p123)

**Security Scenarios (from `Solution TD2 - Exercice 5 Q2`):**
-   **Two different certificates signed by the same private key:** This is normal. A CA uses its single private key to sign many different certificates for different subjects.
-   **Two different certificates contain the same public key:**
    -   If they belong to the *same person/entity* (e.g., renewed certificate), it's generally fine.
    -   If they belong to *two different people/entities*, this is a major security problem. It implies either a compromised CA, a fraudulent certificate, or a key collision (highly unlikely for strong keys). It would mean messages encrypted for one could be decrypted by the other, and signatures could be ambiguous.
[[Q14]]
## 9. Secure Communication Protocols and Applications

### SSH (Secure Shell)

-   Provides secure remote login, command execution, and file transfer, replacing insecure protocols like Telnet and rlogin.
-   **Process:**
    1.  Server sends its public key to the client.
    2.  Client verifies server's public key (often by checking if it's seen it before, or via a trust model).
    3.  Client and server perform a key exchange (e.g., Diffie-Hellman) to establish a shared symmetric session key.
    4.  All subsequent communication is encrypted using this session key.
-   **Vulnerability:** Susceptible to Man-in-the-Middle (MITM) attacks if the server's public key is not properly verified during the initial connection.

(Source: `FILE 3 - The SSH Protocol (Secure Shell)`, `FILE 3 - Flaw of the SSH Protocol`)

### SSL/TLS (Secure Sockets Layer / Transport Layer Security)

-   Protocols that provide secure communication over a computer network. Widely used for HTTPS (secure web browsing).
-   **Layers:** Operates between the Application Layer and Transport Layer.
-   **Provides:**
    -   **Confidentiality:** Encrypts data.
    -   **Integrity:** Ensures data is not tampered with (using MACs).
    -   **Authentication:** Can authenticate the server (common) and optionally the client (less common) using digital certificates.
-   TLS is the successor to SSL. (TLS 1.0, 1.1, 1.2, 1.3 are common versions).

(Source: `FILE 3 - SSL/TLS`)

### VPN (Virtual Private Network)

-   Creates a secure, encrypted "tunnel" over an insecure network (like the internet), allowing private network traffic to be transmitted securely.
-   **IPsec (Internet Protocol Security):** A common suite of protocols used for VPNs:
    -   **AH (Authentication Header):** Provides integrity and authentication for IP packets.
    -   **ESP (Encapsulating Security Payload):** Provides confidentiality (encryption), and optionally integrity and authentication.
    -   **IKE (Internet Key Exchange):** Used for negotiating security parameters and exchanging keys.
-   Other VPN protocols include PPTP, L2TP.

(Source: `FILE 3 - VPN Network (Virtual Private Network)`)

### PGP (Pretty Good Privacy)

-   Software for email and file encryption, decryption, and signing.
-   **Hybrid System:**
    -   Uses symmetric encryption (e.g., AES) with a randomly generated one-time **session key** for message content.
    -   Encrypts the session key using the recipient's public key (RSA or similar).
    -   Also uses data compression.
-   Often relies on a "Web of Trust" model for public key validation, rather than a strict hierarchical PKI.

(Source: `FILE 3 - The PGP Tool`)

### Kerberos

-   Network authentication protocol designed to provide strong authentication for client/server applications by using secret-key cryptography.
-   Uses a system of "tickets" to authenticate users to services and services to users.
-   Relies on a trusted third party: Key Distribution Center (KDC), which consists of an Authentication Server (AS) and a Ticket-Granting Server (TGS).
-   Entirely based on symmetric encryption.

(Source: `FILE 3 - The Kerberos Protocol`)

### Summary of Security Objectives and Mechanisms

| Objective         | Cryptographic Mechanism                                                              |
|-------------------|--------------------------------------------------------------------------------------|
| Confidentiality   | Symmetric encryption (e.g., AES for message), Asymmetric encryption (e.g., RSA for session key) |
| Integrity         | Hash functions (e.g., SHA-256), MACs, Digital Signatures                             |
| Authentication    | Digital Signatures, MACs, Digital Certificates, Kerberos                             |
| Non-repudiation   | Digital Signatures (based on asymmetric crypto)                                      |
| Key Exchange      | Asymmetric crypto (e.g., RSA to encrypt symmetric key), Diffie-Hellman key exchange    |
| Public Key Trust  | Digital Certificates, PKI, Web of Trust                                              |

[[Q15]]