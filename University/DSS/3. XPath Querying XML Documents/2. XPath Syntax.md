
## Syntaxe générale (General Syntax)

### Chemin Xpath (XPath Path)

#tags: #XPath #path_expression #location_path #node_selection #axes #node_test #predicate

XPath is the language for navigating the XML tree and designating nodes. Designation (selection) can be achieved in several ways:

1.  **Par le nom (par le chemin) / By Name (Path-based):** Using a sequence of element names and slashes, similar to file system paths, to navigate from the root or context node. (This is the abbreviated syntax).
    *   Example: `/biblio/livre/titre`
2.  **Par les pas de localisations (en utilisant des axes, filtres et prédicats) / By Location Steps (using axes, node tests, and predicates):** The full, unabbreviated syntax explicitly specifies the direction of navigation (axis), the type of node to look for (node test/filter), and optional conditions (predicates).
    *   Example: `/child::biblio/child::livre/child::titre`

### Chemins absolus et relatifs (Absolute and Relative Paths)

#tags: #XPath #absolute_path #relative_path #context_node #root_node #abbreviated_syntax

XPath uses path expressions to select nodes. These paths can be absolute (starting from the root) or relative (starting from the current context node).

*   **`/` (Root/Separator):**
    *   When used at the beginning of a path (`/element`), it denotes an **absolute path** starting from the **document root** (the conceptual node above the root element).
    *   When used between steps (`step1/step2`), it separates location steps, indicating a parent-child relationship in the abbreviated syntax.
*   **`//` (Descendant-or-Self Axis Abbreviation):**
    *   Selects nodes anywhere in the document that match the following step, regardless of their depth (searches the entire subtree from the context node, or the whole document if used at the start: `//element`). Corresponds to the `descendant-or-self::node()` axis.
    *   Example: `//C` selects all `<C>` elements anywhere in the document.
*   **`.` (Self Axis Abbreviation):**
    *   Selects the **context node** itself. Corresponds to the `self::node()` axis.
*   **`..` (Parent Axis Abbreviation):**
    *   Selects the **parent** of the context node. Corresponds to the `parent::node()` axis.
*   **`nom` or `prefix:nom` (Name Test):**
    *   Selects child elements with the specified name relative to the context node. (Abbreviation for `child::nom`).
    *   Example: `B` selects `<B>` element children.
*   **`@nom` or `@prefix:nom` (Attribute Axis Abbreviation):**
    *   Selects attributes with the specified name on the context node. (Abbreviation for `attribute::nom`).
    *   Example: `@id` selects the `id` attribute.

**Example XML Document (Slide 6):**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<A>
  <B><C>C1</C></B> 
  <B><C>C2</C></B>
  <D><C>C3</C></D>
  <E><B><C>C4</C></B></E> 
  <B id="2"><C>C5</C></B> 
</A>
```

**Path Examples (Slides 7-16):**

(Assuming context is the root node `/` unless otherwise specified)

*   `/*` : Selects the root element (`<A>`).
    *   *Result: `<A>...<A>`*
*   `/*/*/C` : Selects all `<C>` elements that are grandchildren of the root element (`<A>`).
    *   *Result: `<C>C1</C>`, `<C>C2</C>`, `<C>C3</C>`*
*   `//C` : Selects all `<C>` elements anywhere in the document.
    *   *Result: `<C>C1</C>`, `<C>C2</C>`, `<C>C3</C>`, `<C>C4</C>`, `<C>C5</C>`*
*   `/*/B/C` : Selects `<C>` elements that are children of `<B>` elements that are children of the root element (`<A>`).
    *   *Result: `<C>C1</C>`, `<C>C2</C>`, `<C>C5</C>`*
*   `*/B//C` : Selects `<C>` elements that are descendants of `<B>` elements that are children of the root element (`<A>`).
    *   *Result: `<C>C1</C>`, `<C>C2</C>`, `<C>C4</C>`, `<C>C5</C>`*
*   `/A/B/*` : Selects all element children of `<B>` elements that are children of `<A>`. Also selects the element child of the `<E>` element which is the grandchild of `<A>`. *(Slight inaccuracy in slide description - selects children of B-under-A, and children of B-under-E-under-A. The target nodes are the C elements, plus the E element if we consider `/A/B` selects all B children, but the example `E avec id=2` is confusing here)*. Correct interpretation: Selects children of `/A/B` (i.e., C1, C2, C5) and children of `/A/E/B` (i.e., C4). The E element with id=2 (`/A/B[@id='2']`) is selected by `/A/B`, its child is C5.
    *   *Let's reinterpret the goal: Select C1, C2, C5 and the E element containing C4:* `/A/B/C | /A/E` might be closer.
    *   *Let's reinterpret based on result: Select C1, C2, C4, C5 and the E element with id=2:* This seems unlikely with a single simple path. `/A/B/C | //B[@id='2']/C | /A/E` selects C1, C2, C5 and E. Selecting C4 requires `//E/B/C`.
    *   **Let's stick to the simplest interpretation:** `/A/B/*` selects element children of `/A/B` elements => `<C>C1</C>`, `<C>C2</C>`, `<C>C5</C>`. The description seems flawed.
*   `./B/C` : (If context is `<A>`) Selects `<C>` children of `<B>` children of the context node (`<A>`).
    *   *Result: `<C>C1</C>`, `<C>C2</C>`, `<C>C5</C>`*
*   `/*/*/*/C` : Selects `<C>` elements that are great-grandchildren of the root.
    *   *Result: `<C>C4</C>`*
*   `//*` : Selects all elements in the document.
    *   *Result: `<A>`, `<B>`, `<C>`, `<B>`, `<C>`, `<D>`, `<C>`, `<E>`, `<B>`, `<C>`, `<B>`, `<C>`*

*(Note: Some interpretations in the slide examples (like `/A/B/*`) seem slightly inconsistent with standard XPath behavior or describe the result unclearly. The results listed above follow standard interpretation.)*

### Pas de localisation (Location Step)

#tags: #XPath #location_step #axis #node_test #predicate #XPath_syntax

An XPath path is composed of one or more **location steps**, separated by `/`. Each location step selects a set of nodes relative to the context node established by the previous step.

**General Syntax (Unabbreviated):**

```
axis :: node-test [predicate1] [predicate2] ...
```

A location step has three parts:

1.  **`axe` (Axis):** Specifies the navigational direction or relationship between the selected nodes and the context node (e.g., child, parent, descendant, attribute).
2.  **`test (filtre)` (Node Test / Filter):** Specifies the type or name of the node(s) to be selected along the specified axis.
3.  **`prédicat` (Predicate):** (Optional) A boolean expression enclosed in square brackets `[...]` used to further filter the nodes selected by the axis and node test. Multiple predicates can be applied sequentially.

**Example Breakdown (Slide 23):**

Path: `/ descendant :: livre [ annee = 1964 ]`

*   `/`: Start from the document root.
*   **Location Step:**
    *   **Axis:** `descendant` (Selects descendants of the context node - initially the root).
    *   **Node Test:** `livre` (Selects only nodes that are elements named `livre`).
    *   **Predicate:** `[annee = 1964]` (Filters the selected `<livre>` elements, keeping only those where the value of their `annee` attribute equals the number 1964). *(Note: Assumes `annee` is an attribute here, XPath 1.0 might compare string value of a child element too)*.

**Example Breakdown (Slide 25):**

Path: `/ child :: edition / child :: livre`

*   **Step 1:** `child :: edition`
    *   **Context:** Document root (`/`)
    *   **Axis:** `child`
    *   **Node Test:** `edition`
    *   *Result:* Selects the `<edition>` element child of the root.
*   **Step 2:** `child :: livre`
    *   **Context:** The `<edition>` element selected in Step 1.
    *   **Axis:** `child`
    *   **Node Test:** `livre`
    *   *Result:* Selects all `<livre>` element children of the `<edition>` element.

### Syntaxe générale (Location Step Components Explained)

#tags: #XPath #axis #node_test #predicate #node_selection #filtering

*   **Axe (Axis):** Defines the direction of movement in the XML tree relative to the current context node. It determines the initial set of candidate nodes. Examples: `child`, `parent`, `descendant`, `ancestor`, `following-sibling`, `preceding-sibling`, `attribute`, `self`, `namespace`.
*   **Filtre (Node Test):** Filters the nodes selected by the axis based on their type and/or name.
    *   `name`: Selects elements with the specific `name`.
    *   `*`: Selects all elements on the axis.
    *   `node()`: Selects any node of any type (element, text, comment, PI, attribute).
    *   `text()`: Selects text nodes.
    *   `comment()`: Selects comment nodes.
    *   `processing-instruction()`: Selects processing instruction nodes.
    *   `prefix:name`: Selects elements with the specific `name` in the namespace associated with `prefix`.
*   **Prédicat optionnel (Optional Predicate):** A boolean expression in `[...]` that further filters the nodes selected by the axis and node test. It's evaluated for each node in the selected set; only nodes where the predicate evaluates to true are kept. Predicates often involve comparisons, function calls, or checks for the existence of sub-nodes/attributes.

### Exemples Multiples (Combining Steps)

#tags: #XPath #abbreviated_syntax #location_path #examples

**Abbreviated Syntax:** The full `axis::node-test[predicate]` syntax is often shortened for common cases.

*   `/child::edition/child::livre` can be written as `/edition/livre`.
    *   `pas1` (step 1): `child::edition` -> `edition`
    *   `pas2` (step 2): `child::livre` -> `livre`
*   `child::x` or just `x`: Selects child elements named "x". `./x` is equivalent if `.` is the context.
*   `child::x/child::y` or just `x/y`: Selects child elements named "y" that are children of child elements named "x". `./x/y` is equivalent.
*   `attribute::a` or just `@a`: Selects the attribute named "a" of the context node.
*   `child::*` or just `*`: Selects all element children of the context node.
*   `/descendant-or-self::node()/child::x` or just `//x`: Selects all elements named "x" anywhere in the document starting from the root.

---

